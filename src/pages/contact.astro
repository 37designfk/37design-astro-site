---
import Layout from "../layouts/Layout.astro";
import Header from "../components/Header.astro";
import Footer from "../components/Footer.astro";
import "../styles/global.css";
import ParticleCanvas from "../components/ParticleCanvas.astro";

const inquiryTypes = [
  "業務自動化について",
  "CRM・顧客管理の導入",
  "AI導入・活用について",
  "料金・プランについて",
  "その他",
];

const faqs = [
  {
    q: "ITに詳しくなくても大丈夫ですか？",
    a: "はい、まったく問題ありません。専門知識は一切不要です。ツールの操作方法から丁寧にご説明し、マニュアルもお渡しします。「パソコンはメールとExcelくらい」というお客様にも多くご利用いただいています。",
  },
  {
    q: "本当に1週間で導入できるのですか？",
    a: "スターターパックの場合、ヒアリングから初期導入まで最短1週間で対応可能です。ただし、業務の複雑さや既存システムとの連携が必要な場合は、2〜4週間程度いただくこともあります。事前のヒアリングで正確なスケジュールをお伝えします。",
  },
  {
    q: "費用はどのくらいかかりますか？",
    a: "スターターパックは30万円〜、スタンダードパックは80万円〜が目安です。まずは無料ヒアリングで課題を整理し、最適なプランとお見積りをご提示します。無料診断だけでも構いませんので、お気軽にご相談ください。",
  },
  {
    q: "既存のシステムと連携できますか？",
    a: "多くの場合、連携可能です。kintone、Salesforce、freee、マネーフォワード、各種Googleサービスなど、主要なビジネスツールとの連携実績があります。現在お使いのシステムをヒアリング時にお知らせください。",
  },
  {
    q: "導入後のサポートはありますか？",
    a: "すべてのプランに導入後サポート期間が含まれています。サポート期間中は、操作のご質問・設定変更・トラブル対応に無料で対応します。サポート期間終了後も、月額保守プラン（オプション）で継続的な支援が可能です。",
  },
  {
    q: "まだ具体的なイメージがないのですが相談できますか？",
    a: "もちろんです。「業務を効率化したいけど何から始めればいいかわからない」というご相談が最も多いです。無料ヒアリングで現在の業務をお伺いし、どこを自動化・AI化すれば効果が大きいかをご提案します。",
  },
];
---

<Layout
  title="お問い合わせ | 株式会社37Design"
  description="株式会社37Designへのお問い合わせはこちら。お電話、LINE、お問い合わせフォームから、お気軽にご相談ください。平日9:00-18:00対応。"
>
  <Header />

  <main>
    <!-- Hero Section -->
    <section class="relative min-h-[50vh] flex items-center hero-gradient overflow-hidden">
      <ParticleCanvas />

      <div class="absolute inset-0 pointer-events-none z-[2]" aria-hidden="true">
        <div class="absolute top-[20%] right-[15%] w-72 h-72 bg-glow/8 rounded-full blur-[100px] hero-float"></div>
        <div class="absolute bottom-[10%] left-[10%] w-96 h-96 bg-accent-400/5 rounded-full blur-[120px] hero-float-delay"></div>
      </div>

      <div class="relative z-20 max-w-5xl mx-auto px-4 md:px-6 lg:px-8 py-20 md:py-24 w-full text-center">
        <div class="inline-flex items-center gap-2 px-4 py-1.5 rounded-full bg-white/10 border border-white/10 backdrop-blur-sm mb-6">
          <span class="w-2 h-2 rounded-full bg-green-400 animate-pulse"></span>
          <span class="text-white/70 text-xs font-medium">無料相談受付中</span>
        </div>

        <h1 class="text-[clamp(2rem,5vw,3.5rem)] font-black text-white leading-[1.15] mb-6">
          お問い合わせ
        </h1>

        <p class="text-white/70 text-base md:text-lg leading-relaxed max-w-2xl mx-auto">
          お電話、LINE、フォームからお気軽にご相談ください。<br class="hidden md:block" />
          「何から始めればいい？」でも大丈夫です。
        </p>
      </div>
    </section>

    <!-- Contact Methods -->
    <section class="py-16 md:py-20 bg-surface">
      <div class="max-w-6xl mx-auto px-4 md:px-6 lg:px-8">
        <div class="text-center mb-12">
          <h2 class="text-2xl md:text-3xl font-bold text-text-primary mb-4">
            3つの方法からお選びください
          </h2>
          <p class="text-text-secondary">ご都合の良い方法でお気軽にお問い合わせください</p>
        </div>

        <div class="grid md:grid-cols-3 gap-6 mb-16">
          <!-- Phone -->
          <div class="bg-white rounded-2xl p-8 border border-border hover:border-primary-400 hover:shadow-lg transition-all group">
            <div class="w-16 h-16 rounded-2xl bg-gradient-to-br from-primary-600 to-primary-700 flex items-center justify-center mb-5 mx-auto group-hover:scale-110 transition-transform">
              <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 6.75c0 8.284 6.716 15 15 15h2.25a2.25 2.25 0 0 0 2.25-2.25v-1.372c0-.516-.351-.966-.852-1.091l-4.423-1.106c-.44-.11-.902.055-1.173.417l-.97 1.293c-.282.376-.769.542-1.21.38a12.035 12.035 0 0 1-7.143-7.143c-.162-.441.004-.928.38-1.21l1.293-.97c.363-.271.527-.734.417-1.173L6.963 3.102a1.125 1.125 0 0 0-1.091-.852H4.5A2.25 2.25 0 0 0 2.25 4.5v2.25Z" />
              </svg>
            </div>
            <h3 class="text-xl font-bold text-text-primary mb-3 text-center">お電話で相談</h3>
            <p class="text-sm text-text-secondary mb-5 text-center">
              すぐに相談したい方におすすめ
            </p>
            <div class="text-center mb-5">
              <a href="tel:080-2412-2556" class="text-2xl font-bold text-primary-600 hover:text-primary-700 transition-colors">
                080-2412-2556
              </a>
              <p class="text-xs text-text-muted mt-2">平日 9:00 - 18:00</p>
            </div>
            <a
              href="tel:080-2412-2556"
              class="block w-full py-3 px-4 bg-primary-600 text-white font-semibold rounded-full hover:bg-primary-700 transition-colors text-center text-sm"
            >
              電話をかける
            </a>
          </div>

          <!-- LINE -->
          <div class="bg-white rounded-2xl p-8 border border-border hover:border-[#06C755] hover:shadow-lg transition-all group">
            <div class="w-16 h-16 rounded-2xl bg-gradient-to-br from-[#06C755] to-[#05B34A] flex items-center justify-center mb-5 mx-auto group-hover:scale-110 transition-transform">
              <svg class="w-8 h-8 text-white" fill="currentColor" viewBox="0 0 24 24">
                <path d="M19.365 9.863c.349 0 .63.285.63.631 0 .345-.281.63-.63.63H17.61v1.125h1.755c.349 0 .63.283.63.63 0 .344-.281.629-.63.629h-2.386c-.345 0-.627-.285-.627-.629V8.108c0-.345.282-.63.63-.63h2.386c.346 0 .627.285.627.63 0 .349-.281.63-.63.63H17.61v1.125h1.755zm-3.855 3.016c0 .27-.174.51-.432.596-.064.021-.133.031-.199.031-.211 0-.391-.09-.51-.25l-2.443-3.317v2.94c0 .344-.279.629-.631.629-.346 0-.626-.285-.626-.629V8.108c0-.27.173-.51.43-.595.06-.023.136-.033.194-.033.195 0 .375.104.495.254l2.462 3.33V8.108c0-.345.282-.63.63-.63.345 0 .63.285.63.63v4.771zm-5.741 0c0 .344-.282.629-.631.629-.345 0-.627-.285-.627-.629V8.108c0-.345.282-.63.627-.63.349 0 .631.285.631.63v4.771zm-2.466.629H4.917c-.345 0-.63-.285-.63-.629V8.108c0-.345.285-.63.63-.63.348 0 .63.285.63.63v4.141h1.756c.348 0 .629.283.629.63 0 .344-.281.629-.629.629M24 10.314C24 4.943 18.615.572 12 .572S0 4.943 0 10.314c0 4.811 4.27 8.842 10.035 9.608.391.082.923.258 1.058.59.12.301.079.766.038 1.08l-.164 1.02c-.045.301-.24 1.186 1.049.645 1.291-.539 6.916-4.078 9.436-6.975C23.176 14.393 24 12.458 24 10.314" />
              </svg>
            </div>
            <h3 class="text-xl font-bold text-text-primary mb-3 text-center">LINEで相談</h3>
            <p class="text-sm text-text-secondary mb-5 text-center">
              チャットで気軽に質問したい方
            </p>
            <div class="text-center mb-5">
              <p class="text-sm text-text-body">
                24時間受付<br />
                <span class="text-xs text-text-muted">（返信は営業時間内）</span>
              </p>
            </div>
            <a
              href="https://jmp9xv65.autosns.app/line"
              target="_blank"
              rel="noopener noreferrer"
              class="block w-full py-3 px-4 bg-[#06C755] text-white font-semibold rounded-full hover:bg-[#05B34A] transition-colors text-center text-sm"
            >
              LINEで相談する
            </a>
          </div>

          <!-- Form -->
          <div class="bg-white rounded-2xl p-8 border border-border hover:border-accent-400 hover:shadow-lg transition-all group">
            <div class="w-16 h-16 rounded-2xl bg-gradient-to-br from-accent-500 to-accent-400 flex items-center justify-center mb-5 mx-auto group-hover:scale-110 transition-transform">
              <svg class="w-8 h-8 text-primary-950" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" d="M21.75 6.75v10.5a2.25 2.25 0 0 1-2.25 2.25h-15a2.25 2.25 0 0 1-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25m19.5 0v.243a2.25 2.25 0 0 1-1.07 1.916l-7.5 4.615a2.25 2.25 0 0 1-2.36 0L3.32 8.91a2.25 2.25 0 0 1-1.07-1.916V6.75" />
              </svg>
            </div>
            <h3 class="text-xl font-bold text-text-primary mb-3 text-center">フォームで相談</h3>
            <p class="text-sm text-text-secondary mb-5 text-center">
              詳しい内容を伝えたい方
            </p>
            <div class="text-center mb-5">
              <p class="text-sm text-text-body">
                24時間受付<br />
                <span class="text-xs text-text-muted">1営業日以内に返信</span>
              </p>
            </div>
            <a
              href="#form"
              class="block w-full py-3 px-4 bg-accent-400 text-primary-950 font-semibold rounded-full hover:bg-accent-300 transition-colors text-center text-sm"
            >
              フォームを入力する
            </a>
          </div>
        </div>

        <!-- Trust Badges -->
        <div class="bg-gradient-to-r from-accent-500/10 to-accent-400/10 rounded-2xl p-6 md:p-8 border border-accent-400/20">
          <div class="grid md:grid-cols-4 gap-6 text-center">
            <div class="flex flex-col items-center gap-2">
              <svg class="w-8 h-8 text-accent-600" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" d="m4.5 12.75 6 6 9-13.5" />
              </svg>
              <p class="text-sm font-semibold text-text-primary">相談・見積り無料</p>
            </div>
            <div class="flex flex-col items-center gap-2">
              <svg class="w-8 h-8 text-accent-600" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" d="m4.5 12.75 6 6 9-13.5" />
              </svg>
              <p class="text-sm font-semibold text-text-primary">無理な営業なし</p>
            </div>
            <div class="flex flex-col items-center gap-2">
              <svg class="w-8 h-8 text-accent-600" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" d="m4.5 12.75 6 6 9-13.5" />
              </svg>
              <p class="text-sm font-semibold text-text-primary">1営業日以内に返信</p>
            </div>
            <div class="flex flex-col items-center gap-2">
              <svg class="w-8 h-8 text-accent-600" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" d="m4.5 12.75 6 6 9-13.5" />
              </svg>
              <p class="text-sm font-semibold text-text-primary">オンライン対応OK</p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Contact Form -->
    <section id="form" class="py-16 md:py-20 bg-surface-alt">
      <div class="max-w-3xl mx-auto px-4 md:px-6 lg:px-8">
        <div class="text-center mb-10">
          <h2 class="text-2xl md:text-3xl font-bold text-text-primary mb-4">お問い合わせフォーム</h2>
          <p class="text-text-secondary">下記フォームに必要事項をご記入の上、送信してください</p>
        </div>

        <form
          id="contact-form"
          class="bg-white rounded-2xl p-8 md:p-10 shadow-lg border border-border"
        >
          <input type="hidden" name="startedAt" id="started-at" value="" />
          <div class="hidden" aria-hidden="true">
            <label for="website">Webサイト</label>
            <input type="text" id="website" name="website" tabindex="-1" autocomplete="off" />
          </div>

          <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4">
            <div>
              <label for="company" class="block text-xs font-semibold text-text-secondary mb-1.5">
                会社名 <span class="text-red-500">*</span>
              </label>
              <input
                type="text"
                id="company"
                name="company"
                required
                placeholder="株式会社〇〇"
                class="w-full px-4 py-3 rounded-lg border border-border bg-surface-alt text-sm text-text-body placeholder-text-muted focus:outline-none focus:ring-2 focus:ring-accent-400 focus:border-transparent transition"
              />
            </div>
            <div>
              <label for="name" class="block text-xs font-semibold text-text-secondary mb-1.5">
                お名前 <span class="text-red-500">*</span>
              </label>
              <input
                type="text"
                id="name"
                name="name"
                required
                placeholder="山田 太郎"
                class="w-full px-4 py-3 rounded-lg border border-border bg-surface-alt text-sm text-text-body placeholder-text-muted focus:outline-none focus:ring-2 focus:ring-accent-400 focus:border-transparent transition"
              />
            </div>
          </div>

          <div class="mb-4">
            <label for="email" class="block text-xs font-semibold text-text-secondary mb-1.5">
              メールアドレス <span class="text-red-500">*</span>
            </label>
            <input
              type="email"
              id="email"
              name="email"
              required
              placeholder="info@example.com"
              class="w-full px-4 py-3 rounded-lg border border-border bg-surface-alt text-sm text-text-body placeholder-text-muted focus:outline-none focus:ring-2 focus:ring-accent-400 focus:border-transparent transition"
            />
          </div>

          <div class="mb-4">
            <label for="phone" class="block text-xs font-semibold text-text-secondary mb-1.5">
              電話番号
            </label>
            <input
              type="tel"
              id="phone"
              name="phone"
              placeholder="080-1234-5678"
              class="w-full px-4 py-3 rounded-lg border border-border bg-surface-alt text-sm text-text-body placeholder-text-muted focus:outline-none focus:ring-2 focus:ring-accent-400 focus:border-transparent transition"
            />
          </div>

          <div class="mb-4">
            <label for="type" class="block text-xs font-semibold text-text-secondary mb-1.5">
              ご相談内容 <span class="text-red-500">*</span>
            </label>
            <select
              id="type"
              name="type"
              required
              class="w-full px-4 py-3 rounded-lg border border-border bg-surface-alt text-sm text-text-body focus:outline-none focus:ring-2 focus:ring-accent-400 focus:border-transparent transition"
            >
              <option value="" disabled selected>選択してください</option>
              {inquiryTypes.map((t) => (
                <option value={t}>{t}</option>
              ))}
            </select>
          </div>

          <div class="mb-6">
            <label for="message" class="block text-xs font-semibold text-text-secondary mb-1.5">
              メッセージ（任意）
            </label>
            <textarea
              id="message"
              name="message"
              rows="6"
              placeholder="現在のお悩みや、気になっていることをお気軽にどうぞ"
              class="w-full px-4 py-3 rounded-lg border border-border bg-surface-alt text-sm text-text-body placeholder-text-muted focus:outline-none focus:ring-2 focus:ring-accent-400 focus:border-transparent transition resize-none"
            ></textarea>
          </div>

          <div class="mb-6">
            <label class="flex items-start gap-3 text-xs text-text-secondary">
              <input
                type="checkbox"
                id="consent"
                name="consent"
                required
                class="mt-0.5 h-4 w-4 rounded border-border text-accent-500 focus:ring-accent-400"
              />
              <span>
                <a href="/privacy" class="text-link hover:underline">プライバシーポリシー</a>に同意して送信します
              </span>
            </label>
          </div>

          <button
            type="submit"
            id="submit-btn"
            class="w-full py-4 bg-accent-400 text-primary-950 font-bold rounded-full hover:bg-accent-300 transition-colors text-base disabled:opacity-50 disabled:cursor-not-allowed"
          >
            送信する
          </button>
          <p class="text-xs text-text-muted text-center mt-3">
            ※ 送信後、1営業日以内にご連絡いたします
          </p>

          <!-- Success message (hidden by default) -->
          <div id="success-msg" class="hidden mt-6 p-4 bg-green-50 border border-green-200 rounded-lg">
            <div class="flex items-center gap-2 text-green-700">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" d="m4.5 12.75 6 6 9-13.5" />
              </svg>
              <p class="font-semibold text-sm">送信完了！</p>
            </div>
            <p class="text-sm text-green-600 mt-1">ありがとうございます。1営業日以内にご連絡いたします。</p>
          </div>
          <p id="form-status" class="hidden mt-4 text-sm font-medium" role="status" aria-live="polite"></p>
        </form>
      </div>
    </section>

    <!-- FAQ Section -->
    <section class="py-16 md:py-20 bg-white">
      <div class="max-w-3xl mx-auto px-4 md:px-6 lg:px-8">
        <div class="text-center mb-12">
          <p class="text-primary-500 text-sm font-semibold tracking-[.2em] uppercase mb-3">FAQ</p>
          <h2 class="text-2xl md:text-3xl font-bold text-text-primary">よくあるご質問</h2>
        </div>

        <div class="flex flex-col gap-3">
          {faqs.map((faq, i) => (
            <details
              class="group rounded-xl border border-border bg-surface-alt overflow-hidden"
            >
              <summary class="flex items-center justify-between gap-4 px-6 py-5 cursor-pointer list-none select-none">
                <div class="flex items-center gap-3">
                  <span class="w-7 h-7 rounded-full bg-accent-400 text-primary-950 flex items-center justify-center text-xs font-bold shrink-0">Q</span>
                  <span class="text-sm md:text-base font-semibold text-text-primary">{faq.q}</span>
                </div>
                <svg class="w-5 h-5 text-text-muted shrink-0 transition-transform group-open:rotate-180" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" d="m19.5 8.25-7.5 7.5-7.5-7.5" />
                </svg>
              </summary>
              <div class="px-6 pb-5">
                <div class="flex gap-3 pt-2 border-t border-border/50">
                  <span class="w-7 h-7 rounded-full bg-primary-950 text-white flex items-center justify-center text-xs font-bold shrink-0 mt-0.5">A</span>
                  <p class="text-sm text-text-body leading-relaxed">{faq.a}</p>
                </div>
              </div>
            </details>
          ))}
        </div>

        <div class="mt-10 text-center">
          <p class="text-sm text-text-secondary mb-4">その他のご質問がある方は、お気軽にお問い合わせください</p>
          <a
            href="#form"
            class="inline-flex items-center gap-2 px-6 py-3 bg-primary-600 text-white font-semibold rounded-full hover:bg-primary-700 transition-colors text-sm"
          >
            お問い合わせフォームへ
          </a>
        </div>
      </div>
    </section>

    <!-- Business Hours -->
    <section class="py-12 bg-surface">
      <div class="max-w-4xl mx-auto px-4 md:px-6 lg:px-8">
        <div class="bg-white rounded-2xl p-8 border border-border">
          <h3 class="text-lg font-bold text-text-primary mb-4 text-center">営業時間・対応について</h3>
          <div class="grid md:grid-cols-2 gap-6 text-sm text-text-body">
            <div>
              <p class="font-semibold text-text-primary mb-2">営業時間</p>
              <p>平日 9:00 - 18:00<br />（土日祝日は休業）</p>
            </div>
            <div>
              <p class="font-semibold text-text-primary mb-2">お問い合わせ対応</p>
              <p>フォーム・LINE：24時間受付<br />電話：営業時間内</p>
            </div>
          </div>
          <p class="text-xs text-text-muted mt-6 text-center">
            ※ 営業時間外のお問い合わせは、翌営業日に順次対応させていただきます
          </p>
        </div>
      </div>
    </section>
  </main>

  <Footer />
</Layout>

<script is:inline>
  document.addEventListener('DOMContentLoaded', function() {
    const form = document.getElementById('contact-form');
    const submitBtn = document.getElementById('submit-btn');
    const successMsg = document.getElementById('success-msg');
    const startedAtInput = document.getElementById('started-at');
    const statusMsg = document.getElementById('form-status');
    const consentInput = document.getElementById('consent');
    const honeypotInput = document.getElementById('website');
    const RATE_LIMIT_KEY = 'contact_page_last_submitted_at';
    const RATE_LIMIT_MS = 60 * 1000;
    const MIN_FILL_TIME_MS = 4000;
    const readStorage = (key) => {
      try {
        return localStorage.getItem(key);
      } catch (_) {
        return null;
      }
    };
    const writeStorage = (key, value) => {
      try {
        localStorage.setItem(key, value);
      } catch (_) {}
    };

    const showStatus = (message, isError) => {
      if (!statusMsg) return;
      statusMsg.textContent = message;
      statusMsg.classList.remove('hidden', 'text-red-600', 'text-green-600');
      statusMsg.classList.add(isError ? 'text-red-600' : 'text-green-600');
    };

    if (startedAtInput) {
      startedAtInput.value = String(Date.now());
    }

    form?.addEventListener('submit', async function(e) {
      e.preventDefault();

      if (!submitBtn || !form) return;
      if (successMsg) successMsg.classList.add('hidden');
      if (!consentInput || !consentInput.checked) {
        showStatus('プライバシーポリシーへの同意が必要です。', true);
        return;
      }
      if (honeypotInput && honeypotInput.value) {
        showStatus('送信内容を確認できませんでした。時間をおいて再度お試しください。', true);
        return;
      }
      const startedAt = Number(startedAtInput?.value || '0');
      if (!startedAt || Date.now() - startedAt < MIN_FILL_TIME_MS) {
        showStatus('入力時間が短すぎます。内容をご確認のうえ再送信してください。', true);
        return;
      }
      const lastSubmittedAt = Number(readStorage(RATE_LIMIT_KEY) || '0');
      if (Date.now() - lastSubmittedAt < RATE_LIMIT_MS) {
        showStatus('連続送信を防ぐため、1分ほど待ってから再送信してください。', true);
        return;
      }

      // Disable submit button
      submitBtn.disabled = true;
      submitBtn.textContent = '送信中...';
      showStatus('送信しています...', false);

      const formData = new FormData(form);
      const data = {
        company: formData.get('company'),
        name: formData.get('name'),
        email: formData.get('email'),
        phone: formData.get('phone') || '',
        type: formData.get('type'),
        message: formData.get('message') || '',
      };

      try {
        const response = await fetch('https://n8n-onprem.37d.jp/webhook/ai-diagnosis', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(data),
        });

        if (response.ok) {
          // Show success message
          form.reset();
          writeStorage(RATE_LIMIT_KEY, String(Date.now()));
          if (startedAtInput) startedAtInput.value = String(Date.now());
          successMsg?.classList.remove('hidden');
          showStatus('送信が完了しました。ありがとうございます。', false);

          // Scroll to success message
          successMsg?.scrollIntoView({ behavior: 'smooth', block: 'nearest' });

          // Hide success message after 5 seconds
          setTimeout(() => {
            successMsg?.classList.add('hidden');
          }, 5000);
        } else {
          showStatus('送信に失敗しました。時間をおいてもう一度お試しください。', true);
        }
      } catch (error) {
        console.error('Error:', error);
        showStatus('通信エラーが発生しました。時間をおいて再度お試しください。', true);
      } finally {
        // Re-enable submit button
        submitBtn.disabled = false;
        submitBtn.textContent = '送信する';
      }
    });
  });
</script>
