---
import Layout from "../layouts/Layout.astro";
import Header from "../components/Header.astro";
import Footer from "../components/Footer.astro";
import "../styles/global.css";
import ParticleCanvas from "../components/ParticleCanvas.astro";
import { serviceCategories } from "../data/service-categories";
---

<Layout
  title="サービス一覧 | 株式会社37Design"
  description="株式会社37Designが提供するサービス一覧。システム開発、Webサイト制作、Webマーケティング、業務自動化、デザインなど、幅広いデジタルソリューションをワンストップで提供します。"
>
  <Header />

  <main>
    <!-- Hero Section -->
    <section class="relative min-h-[50vh] flex items-center hero-gradient overflow-hidden">
      <ParticleCanvas />

      <div class="absolute inset-0 pointer-events-none z-[2]" aria-hidden="true">
        <div class="absolute top-[20%] right-[15%] w-72 h-72 bg-glow/8 rounded-full blur-[100px] hero-float"></div>
        <div class="absolute bottom-[10%] left-[10%] w-96 h-96 bg-accent-400/5 rounded-full blur-[120px] hero-float-delay"></div>
      </div>

      <div class="relative z-20 max-w-5xl mx-auto px-4 md:px-6 lg:px-8 py-20 md:py-24 w-full text-center">
        <div class="inline-flex items-center gap-2 px-4 py-1.5 rounded-full bg-white/10 border border-white/10 backdrop-blur-sm mb-6">
          <span class="text-white/70 text-xs font-medium">Services</span>
        </div>

        <h1 class="text-[clamp(2rem,5vw,3.5rem)] font-black text-white leading-[1.15] mb-6">
          提供サービス一覧
        </h1>

        <p class="text-white/70 text-base md:text-lg leading-relaxed max-w-2xl mx-auto">
          システム開発からマーケティングまで、<br class="hidden md:block" />
          ビジネスに必要なデジタルソリューションをワンストップで提供します。
        </p>
      </div>
    </section>

    <!-- Services Grid -->
    {serviceCategories.map((category, idx) => (
      <section class={`py-16 md:py-20 ${idx % 2 === 0 ? 'bg-surface' : 'bg-surface-alt'}`}>
        <div class="max-w-7xl mx-auto px-4 md:px-6 lg:px-8">
          <!-- Category Header -->
          <div class="flex items-center gap-4 mb-10">
            <div class={`w-14 h-14 rounded-xl bg-gradient-to-br ${category.color} flex items-center justify-center shrink-0`}>
              <svg class="w-7 h-7 text-white" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" d={category.icon} />
              </svg>
            </div>
            <div>
              <h2 class="text-2xl md:text-3xl font-bold text-text-primary">{category.category}</h2>
              <p class="text-sm text-text-muted">{category.services.length}つのサービス</p>
            </div>
          </div>

          <!-- Services Grid -->
          <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            {category.services.map((service) => (
              <div class="group bg-white rounded-xl p-6 border border-border hover:border-accent-400/40 hover:shadow-lg transition-all duration-300">
                <div class="flex items-start gap-3 mb-3">
                  <div class={`w-2 h-2 rounded-full bg-gradient-to-br ${category.color} mt-2 shrink-0 group-hover:scale-125 transition-transform`}></div>
                  <h3 class="text-lg font-bold text-text-primary group-hover:text-accent-600 transition-colors">
                    {service.name}
                  </h3>
                </div>
                <p class="text-sm text-text-secondary leading-relaxed pl-5">
                  {service.description}
                </p>
              </div>
            ))}
          </div>
        </div>
      </section>
    ))}

    <!-- CTA Section -->
    <section class="py-16 md:py-20 bg-primary-800 relative overflow-hidden">
      <!-- Background glow -->
      <div class="absolute inset-0 pointer-events-none" aria-hidden="true">
        <div class="absolute top-0 left-1/4 w-96 h-96 bg-glow/5 rounded-full blur-[120px]"></div>
        <div class="absolute bottom-0 right-1/4 w-80 h-80 bg-accent-400/5 rounded-full blur-[100px]"></div>
      </div>

      <div class="relative max-w-4xl mx-auto px-4 md:px-6 lg:px-8 text-center">
        <h2 class="text-2xl md:text-3xl lg:text-4xl font-bold text-white mb-4">
          どのサービスが最適か<br class="md:hidden" />わからない方へ
        </h2>
        <p class="text-white/60 text-base md:text-lg mb-8 max-w-2xl mx-auto">
          お悩みやご要望をお聞かせください。<br />
          最適なソリューションをご提案いたします。
        </p>

        <div class="flex flex-col sm:flex-row gap-4 justify-center">
          <a
            href="#contact"
            class="inline-flex items-center justify-center gap-2 px-8 py-4 bg-accent-400 text-primary-950 font-bold rounded-full hover:bg-accent-300 transition-colors text-base"
          >
            <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" d="M21.75 6.75v10.5a2.25 2.25 0 0 1-2.25 2.25h-15a2.25 2.25 0 0 1-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25m19.5 0v.243a2.25 2.25 0 0 1-1.07 1.916l-7.5 4.615a2.25 2.25 0 0 1-2.36 0L3.32 8.91a2.25 2.25 0 0 1-1.07-1.916V6.75" />
            </svg>
            無料相談を申し込む
          </a>

          <a
            href="https://jmp9xv65.autosns.app/line"
            target="_blank"
            rel="noopener noreferrer"
            class="inline-flex items-center justify-center gap-2 px-8 py-4 bg-[#06C755] text-white font-semibold rounded-full hover:bg-[#05B34A] transition-colors text-base"
          >
            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
              <path d="M19.365 9.863c.349 0 .63.285.63.631 0 .345-.281.63-.63.63H17.61v1.125h1.755c.349 0 .63.283.63.63 0 .344-.281.629-.63.629h-2.386c-.345 0-.627-.285-.627-.629V8.108c0-.345.282-.63.63-.63h2.386c.346 0 .627.285.627.63 0 .349-.281.63-.63.63H17.61v1.125h1.755zm-3.855 3.016c0 .27-.174.51-.432.596-.064.021-.133.031-.199.031-.211 0-.391-.09-.51-.25l-2.443-3.317v2.94c0 .344-.279.629-.631.629-.346 0-.626-.285-.626-.629V8.108c0-.27.173-.51.43-.595.06-.023.136-.033.194-.033.195 0 .375.104.495.254l2.462 3.33V8.108c0-.345.282-.63.63-.63.345 0 .63.285.63.63v4.771zm-5.741 0c0 .344-.282.629-.631.629-.345 0-.627-.285-.627-.629V8.108c0-.345.282-.63.627-.63.349 0 .631.285.631.63v4.771zm-2.466.629H4.917c-.345 0-.63-.285-.63-.629V8.108c0-.345.285-.63.63-.63.348 0 .63.285.63.63v4.141h1.756c.348 0 .629.283.629.63 0 .344-.281.629-.629.629M24 10.314C24 4.943 18.615.572 12 .572S0 4.943 0 10.314c0 4.811 4.27 8.842 10.035 9.608.391.082.923.258 1.058.59.12.301.079.766.038 1.08l-.164 1.02c-.045.301-.24 1.186 1.049.645 1.291-.539 6.916-4.078 9.436-6.975C23.176 14.393 24 12.458 24 10.314" />
            </svg>
            LINEで相談
          </a>
        </div>

        <p class="text-white/40 text-xs mt-6">
          お電話でのご相談：<a href="tel:080-2412-2556" class="text-white/60 hover:text-white transition-colors">080-2412-2556</a>（平日 9:00-18:00）
        </p>
      </div>
    </section>

    <!-- Contact Form Section -->
    <section id="contact" class="py-16 md:py-20 lg:py-24 bg-surface-alt">
      <div class="max-w-2xl mx-auto px-4 md:px-6 lg:px-8">
        <div class="text-center mb-10">
          <p class="text-primary-500 text-sm font-semibold tracking-[.2em] uppercase mb-3">Contact</p>
          <h2 class="text-2xl md:text-3xl font-bold text-text-primary mb-4">お問い合わせ</h2>
          <p class="text-text-secondary">サービスに関するご質問・ご相談はお気軽にどうぞ</p>
        </div>

        <form
          id="service-form"
          class="bg-white rounded-2xl p-6 md:p-8 shadow-lg border border-border"
        >
          <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4">
            <div>
              <label for="company" class="block text-xs font-semibold text-text-secondary mb-1.5">
                会社名 <span class="text-red-500">*</span>
              </label>
              <input
                type="text"
                id="company"
                name="company"
                required
                placeholder="株式会社〇〇"
                class="w-full px-4 py-3 rounded-lg border border-border bg-surface-alt text-sm text-text-body placeholder-text-muted focus:outline-none focus:ring-2 focus:ring-accent-400 focus:border-transparent transition"
              />
            </div>
            <div>
              <label for="name" class="block text-xs font-semibold text-text-secondary mb-1.5">
                お名前 <span class="text-red-500">*</span>
              </label>
              <input
                type="text"
                id="name"
                name="name"
                required
                placeholder="山田 太郎"
                class="w-full px-4 py-3 rounded-lg border border-border bg-surface-alt text-sm text-text-body placeholder-text-muted focus:outline-none focus:ring-2 focus:ring-accent-400 focus:border-transparent transition"
              />
            </div>
          </div>

          <div class="mb-4">
            <label for="email" class="block text-xs font-semibold text-text-secondary mb-1.5">
              メールアドレス <span class="text-red-500">*</span>
            </label>
            <input
              type="email"
              id="email"
              name="email"
              required
              placeholder="info@example.com"
              class="w-full px-4 py-3 rounded-lg border border-border bg-surface-alt text-sm text-text-body placeholder-text-muted focus:outline-none focus:ring-2 focus:ring-accent-400 focus:border-transparent transition"
            />
          </div>

          <div class="mb-4">
            <label for="service" class="block text-xs font-semibold text-text-secondary mb-1.5">
              気になるサービス
            </label>
            <select
              id="service"
              name="service"
              class="w-full px-4 py-3 rounded-lg border border-border bg-surface-alt text-sm text-text-body focus:outline-none focus:ring-2 focus:ring-accent-400 focus:border-transparent transition"
            >
              <option value="">選択してください（任意）</option>
              <option value="AI顧問サービス">AI顧問サービス（月額制）</option>
              {serviceCategories.map((cat) => (
                <option value={cat.category}>{cat.category}</option>
              ))}
            </select>
          </div>

          <div class="mb-6">
            <label for="message" class="block text-xs font-semibold text-text-secondary mb-1.5">
              メッセージ（任意）
            </label>
            <textarea
              id="message"
              name="message"
              rows="4"
              placeholder="ご要望やご質問などをお気軽にお書きください"
              class="w-full px-4 py-3 rounded-lg border border-border bg-surface-alt text-sm text-text-body placeholder-text-muted focus:outline-none focus:ring-2 focus:ring-accent-400 focus:border-transparent transition resize-none"
            ></textarea>
          </div>

          <button
            type="submit"
            id="submit-btn"
            class="w-full py-4 bg-accent-400 text-primary-950 font-bold rounded-full hover:bg-accent-300 transition-colors text-base disabled:opacity-50 disabled:cursor-not-allowed"
          >
            送信する
          </button>

          <p class="text-xs text-text-muted text-center mt-3">
            ※ 送信後、1営業日以内にご連絡いたします
          </p>

          <!-- Success message (hidden by default) -->
          <div id="success-msg" class="hidden mt-6 p-4 bg-green-50 border border-green-200 rounded-lg">
            <div class="flex items-center gap-2 text-green-700">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" d="m4.5 12.75 6 6 9-13.5" />
              </svg>
              <p class="font-semibold text-sm">送信完了！</p>
            </div>
            <p class="text-sm text-green-600 mt-1">ありがとうございます。1営業日以内にご連絡いたします。</p>
          </div>
        </form>
      </div>
    </section>
  </main>

  <Footer />
</Layout>

<script>
  import { initFormHandler } from "../lib/form-handler";
  initFormHandler({
    formId: "service-form",
    submitBtnId: "submit-btn",
    successMsgId: "success-msg",
    webhookUrl: "https://n8n-onprem.37d.jp/webhook/ai-diagnosis",
    defaultButtonText: "送信する",
    fieldExtractor: (fd) => ({
      company: fd.get("company") as string,
      name: fd.get("name") as string,
      email: fd.get("email") as string,
      type: fd.get("service")
        ? `サービス問い合わせ：${fd.get("service")}`
        : "サービス問い合わせ",
      message: (fd.get("message") as string) || "",
    }),
  });
</script>
